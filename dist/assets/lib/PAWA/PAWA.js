define(["backbone"],function(t){function e(t){var e="FilterAreadyInChainError",i="filter 添加失败，"+t+" 已经存在，请先remove之后再进行添加！",n=new Error(i);return n.name=e,n.type="PAWA_FILTER_ERROR",n.level="中",n}var i=new Function;return i.prototype=t,i.prototype.constructor=i,_.extend(window.PAWA=new i,{VERSION:"0.0.4",lastHash:"",module:"PAWA",init:function(t){var t=t||{};void 0===t.isSPA&&(t.isSPA=!1),void 0===t.pushState&&(t.pushState=!1),this.router=new PAWA.PAWARouter,this.main=t.main||function(){},this.history.start({pushState:t.pushState}),this.defaultHash=t.defaultHash||PAWA.request.param("index")||"index/index",t.isSPA&&(PAWA.history.handlers.push({callback:_.bind(this.autoload,this),route:/^(.*)$/}),this.navigate()),this.handleStatus.coreConfig=t.coreConfig||{}},navigate:function(t){var e=this.router,t=t||location.hash.substring(1)||this.defaultHash;e.navigate("",{trigger:!1,replace:!0}),e.navigate(t,{trigger:!0,replace:!0})},autoload:function(t){if(this.lastHash===t)throw PAWA.routeStatus=404,PAWA.handleStatus(PAWA.routeStatus,t),Error("404: not found uri: "+t);this.lastHash=t;var e=t.split("/"),i=e.splice(0,1);e.join("/");i&&"common"!=i&&(this.main(),this.navigate(t))},addFilter:function(t,i,n,r){var a=this.__filterChain__,s=a._sortedName,o=a._filters,h=s.indexOf(t),u=n===s.length||void 0===n,f=0===n,l="string"==typeof n&&s.indexOf(n);if(h!==-1)throw new e(t);return u?(s.push(t),o[t]=i):f?(s.unshift(t),o[t]=i):l!==-1&&(r?0===l?s.unshift(t):s.splice(l-1,0,t):s.splice(l,0,t),o[t]=i),this},removeFilter:function(t){var e=this.__filterChain__,i=e._sortedName,n=(e._filters,i.indexOf(t));return n!==-1&&i.splice(n,1),this},execFilter:function(t,e,i,n){var r=this.__filterChain__,a=r._sortedName,s=r._filters;n=n||0;var o=s[a[n]];if(o){if("object"==typeof o){for(var h=0,u=o.conditions.length;h<u;h++)if(o.conditions[h].test(e)){o.handler(t,e,i,n);break}h===u&&o.handler(t,e,i,n+1)}return this}},OK_STATUS:"200, 304, 201, 204",__filterChain__:{_sortedName:[],_filters:{}},handleStatus:function(t,e,i,n){this.handleStatus.coreConfig=this.handleStatus.coreConfig||{};var r=this.handleStatus.coreConfig[t],a=!0;if(r)for(var s=0,o=r.length;s<o;s++)if("function"==typeof r[s]&&(a=r[s](e,i,n)),a===!1)return}}),PAWA});
//# sourceMappingURL=PAWA.js.map
